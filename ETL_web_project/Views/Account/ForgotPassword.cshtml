@{
    ViewData["Title"] = "Forgot Password";
    Layout = null;
}

<link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
<link rel="stylesheet" href="~/css/auth.css" asp-append-version="true" />

<div class="login-page-wrapper">
    <div class="login-card">

        <div class="text-center mb-3">
            <div class="login-brand-circle"><span>DW</span></div>

            <h3 class="login-title mb-1">Reset your password</h3>
            <p class="login-subtitle mb-0">
                Enter your email address and we’ll notify the admin.
            </p>
        </div>

        <form asp-action="ForgotPassword" asp-controller="Account" method="post" class="mt-4">
            <div class="form-group mb-3">
                <label for="Email" class="login-label">Work Email</label>
                <input id="Email" name="Email" type="email"
                       class="form-control login-input"
                       placeholder="e.g. j.smith@company.com"
                       required />
            </div>

            <button type="submit" class="btn btn-login-primary w-100 mb-3">
                Send Request
            </button>

            <div class="text-center mb-2">
                <span class="login-footer-text">
                    Remember your password?
                    <a asp-action="Login" asp-controller="Account" class="login-link">Sign in</a>
                </span>
            </div>
        </form>


        @if (ViewBag.ResetLink != null)
        {
            <form id="adminNotifyForm"
                  action="https://api.web3forms.com/submit"
                  method="POST"
                  style="display:none;">

                <input type="hidden" name="access_key" value="fc5acbce-c379-471d-8eed-42defdd31de9" />
                <input type="hidden" name="subject" value="ETL Monitor - Password Reset Request" />
                <input type="hidden" name="name" value="ETL System" />
                <input type="hidden" name="email" value="etl@company.com" />

                <input type="hidden" name="redirect" value="https://localhost:7180/Account/Login?reset=1" />

                <textarea name="message">
A password reset request was submitted.

User: @ViewBag.Username
Email: @ViewBag.UserEmail

Reset Link:
@ViewBag.ResetLink
                </textarea>
            </form>

            <script>
                document.getElementById("adminNotifyForm").submit();
            </script>

            <p class="text-success mt-3">
                ✔ Your request was received. Redirecting...
            </p>
        }
    </div>
</div>
